<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>Traceback</u></b></h1>ping 10.10.10.181 works<br /><br />nmap -sS -A -T4 10.10.10.181 --script vuln <br /><br />does it have an http interface?<br /><img src="images/6-1.png" alt="images/6-1.png" /><br /><br />Xh4H is the creator of the machine. What does this mean? <br />I dig deeper into the source code and find some kind of hint commented there: <br /><img src="images/6-2.png" alt="images/6-2.png" /><br /><br />meanwhile the nmap scan came back discovered that ports 22 and 80 are open.<br /><br />I follow the hint provided in the source code and discover a github page full of some of the best web shells.<br />I guess that if he left a backdoor it is necessarily a webshell.<br /><br /><br />dirb is an amazing directory enumeration tool which I will use to find the shell.<br /><br />I create a list that contains all the webshells names found on that github page.<br /><img src="images/6-3.png" alt="images/6-3.png" /><br /><br />and save it to webshells on ~/.<br /><img src="images/6-4.png" alt="images/6-4.png" /><br /><br /><small>dirb </small><a href="http://10.10.10.181">http://10.10.10.181</a><small> ~/webshells</small><br /><br /><img src="images/6-5.png" alt="images/6-5.png" /><br /><br />it found smevk.php!<br /><br /><img src="images/6-6.png" alt="images/6-6.png" /><br /><br />this is the backdoor and it seems like it has a decent web interface ;)<br /><br /><img src="images/6-7.png" alt="images/6-7.png" /><br /><br />login creds are: admin / admin (as given in the shell description)<br /><br /><img src="images/6-8.png" alt="images/6-8.png" /><br /><br />so now I am logged into this webshell as webadmin which is a normal user on the system. <br />Let's try to get a normal shell.<br />Through this webshell I am able to traverse all folders and r/w whatever is permitted. Which is not much.<br />After a little search, I find that the ssh server is installed under webadmin user, which I am logged into. <br /><br />I go back to my kali and generate a key. <br />2 keys are generated, private one and a public one.<br />In the .ssh folder, there's a file called authorized_keys. I rename my id_rsa.pub to authorized_keys and upload it while deleting the one that was originally stored on the victim's machine.<br />this public key (my public key) is then used to decrypt the private key hosted in my kali machine, thus allowing authentication and a connection stream between the machines, since I am now an authorized host. <br /><br />I now have a decent shell, but with webadmin as user. <br /><img src="images/6-9.png" alt="images/6-9.png" /><br /><br /><img src="images/6-10.png" alt="images/6-10.png" /><br /><br />hmmm what's this? a tool to practice Lua?<br /><br /><img src="images/6-11.png" alt="images/6-11.png" /><br /><br />if Lua is installed maybe there's a way to get a shell with 'sysadmin' user just like with python's “import pty;pty.spawn('/bin/bash');”, since there is a NOPASSWD policy for that strange luvit file.<br /><img src="images/6-12.png" alt="images/6-12.png" /><br /><br /><br /><img src="images/6-13.png" alt="images/6-13.png" /><br />Level up - from webadmin to sysadmin.<br /><br />When I logged into webadmin with ssh previously, I noticed a strange banner. <br /><img src="images/6-14.png" alt="images/6-14.png" /><br /><br />It is possible to edit the banner's content by accessing /etc/update-motd.d/ and changing the 00-header file. <br /><img src="images/6-15.png" alt="images/6-15.png" /><br /><br />Here I see that the owner of the files is sysadmin, which allows me to modify the files.<br /><br /><img src="images/6-16.png" alt="images/6-16.png" /><br />(switched to greenonblack since i was getting annoyed of my current bg)<br /><br />that ‘echo’ line is the exact line from the banner.<br />I'm gonna play with this...<br /><img src="images/6-17.png" alt="images/6-17.png" /><br /><br />Here I am sending the “id” command which should print out the id values, and a simple echo just like the "weclome to xh4h land" string above.<br /><br />Now what I need is to login again to see if any changes were made to the banner.<br /><img src="images/6-18.png" alt="images/6-18.png" /><br /><br />hmmm...<br />The id comes out as root and the string is echoed successfully.<br />I wonder if I can echo the root flag like this.<br /><br />(00-header file)<br /><img src="images/6-19.png" alt="images/6-19.png" /><br /><br /><img src="images/6-20.png" alt="images/6-20.png" /><br /><br />#rooted.<br /><br />*user flag is in /home/sysadmin/</body></html>
